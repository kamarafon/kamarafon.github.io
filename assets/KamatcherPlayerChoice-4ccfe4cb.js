import{d as y,h as w,n as P,o as _,c as C,a as d,u as l,b as i,q as x,f as v,w as q,T as I,s as j,l as B,v as E}from"./index-58cef89c.js";import{u as T}from"./kamatcher-8a12102b.js";import{n as $,c as L,l as N}from"./cards-fa5b6f70.js";import{_ as k}from"./_plugin-vue_export-helper-c27b6911.js";import{G as p}from"./gender-88f8cdbd.js";import{p as R,K as S}from"./KamatcherShowCards-46a0660c.js";import"./store-manager-6441b07d.js";const V={class:"confirm-card"},G=["src"],M={class:"confirmation"},W=y({__name:"KamatcherConfirmation",props:{card:{}},emits:["confirmed","reject"],setup(f,{emit:e}){const{card:s}=f,t=a=>{switch(a.code.toLowerCase()){case"escape":e("reject");break;case"enter":e("confirmed",s);break}};return w(()=>document.addEventListener("keydown",t)),P(()=>document.removeEventListener("keydown",t)),(a,r)=>(_(),C("div",V,[d("img",{alt:"card",src:l($)(a.card)},null,8,G),d("div",M,[d("button",{onClick:r[0]||(r[0]=u=>e("confirmed",a.card))},"выбрать"),d("button",{onClick:r[1]||(r[1]=u=>e("reject"))},"отмена")])]))}});const z=k(W,[["__scopeId","data-v-1c5f0523"]]),U=y({__name:"KamatcherPlayerChoice",setup(f){const e=i.currentRoute.value,{cards:s,level:t,choice:a}=R(e.params,["cards","level","choice"]),r=a&&p.Man||p.Woman,u=T(),c=x(null),h=L(u.cardIds,s,t),b=h.map(n=>({card:n,gender:r})),K=()=>N.chain(h).shuffle().first().value(),g=n=>{if(!a)return i.push({name:"kamatcher-choice",params:{cards:s,level:t,choice:n},query:e.query});i.push({name:"kamatcher-results",params:{cards:s,level:t,woman:a,man:n},query:{...e.query,c:K()}})};return(n,o)=>(_(),C("main",{class:j(["kamatcher","kamatcher-player-"+l(p)[l(r)]])},[v(S,{page:l(b),onSelect:o[0]||(o[0]=m=>c.value=m)},null,8,["page"]),v(I,null,{default:q(()=>[c.value?(_(),B(z,{key:0,onConfirmed:o[1]||(o[1]=m=>g(m)),onReject:o[2]||(o[2]=m=>c.value=null),card:c.value},null,8,["card"])):E("",!0)]),_:1})],2))}});const X=k(U,[["__scopeId","data-v-6abbed5f"]]);export{X as default};
